<!doctype html>
<html ng-app="ui.bootstrap.demo">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular-animate.js"></script>
    <script src="https://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.14.3.js"></script>
    <script>
	var app = angular.module('ui.bootstrap.demo', ['ngAnimate', 'ui.bootstrap']);
	app.factory('ajaxFactory', function ($http, $uibModal) {

		var ajaxFactory = {};
		var modalInstance;
		ajaxFactory.LoadData = function () {
			modalInstance = $uibModal.open({
				animation: true,
				templateUrl: 'myModalContent.html'
			});
			return $http({
				method: "GET",
				url: "http://www.w3schools.com/angular/customers.php",
			});
		};
		
		ajaxFactory.dismissModal = function(){
			if( modalInstance === undefined )
				return;
			
			console.log("Dismiss loading modal.");
			modalInstance.dismiss();
		};
		
		return ajaxFactory;
		
	});
	
	app.controller('ModalDemoCtrl', function ($scope, ajaxFactory) {
		$scope.doAjax = function () {
		
			ajaxFactory.LoadData()
            .success(function (data, status, headers, config) {
                console.log("Data vai factory\n", JSON.stringify(data));
				console.log("Loading finish.")
				ajaxFactory.dismissModal();
            }).error(function (data, status, headers, config) {                          
            });
			
		};
	});
	
	</script>
    <link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
	<div ng-controller="ModalDemoCtrl">
		<script type="text/ng-template" id="myModalContent.html">
			Loading data .......................
		</script>
		<button type="button" class="btn btn-default" ng-click="doAjax()">Execute Ajax</button>
	</div>
  </body>
</html>