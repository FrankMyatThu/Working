@using TestScript.Base.Util;
@{
    ViewBag.Title = "Create Order";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/Application/OrderModule/OrderCreateController.js"></script>
<div class="box-header with-border">
    <h3 class="box-title">Create Order</h3>
</div>
<form name="form" ng-controller="OrderCreateController" role="form">
    <div class="box-body">
        <div ng-show="error" class="alert alert-danger">{{error}}</div>
        <div ng-show="success" class="alert alert-success">{{success}}</div>

        <!-- Description -->
        <div class="form-group" ng-class="{ 'has-error': form.Description.$dirty && (form.Description.$error.required || form.Description.$error.pattern || form.Description.$error.maxlength) }">
            <label for="Description">Description</label>
            <input type="text" name="Description" id="Description" class="form-control" ng-model="item.Description" ng-minlength="1" ng-maxlength="250" ng-pattern="@FormatStandardizer.Client_Name_MultiWord" required />
            <span ng-show="form.Description.$dirty && form.Description.$error.required" class="help-block">Description is required</span>
            <span ng-show="form.Description.$dirty && form.Description.$error.pattern" class="help-block">Invalid Description.</span>
            <span ng-show="form.Description.$dirty && form.Description.$error.maxlength" class="help-block">Maximum length is 250</span>
        </div>

        <!-- OrderDate -->
        <div class="form-group" ng-class="{ 'has-error': form.OrderDate.$dirty && (form.OrderDate.$error.required || form.OrderDate.$error.maxlength) }">
            <label for="OrderDate">Order Date</label>
            <input type="date" name="OrderDate" id="OrderDate" class="form-control" ng-model="item.OrderDate" ng-minlength="1" ng-maxlength="50" required />
            <span ng-show="form.OrderDate.$dirty && form.OrderDate.$error.required" class="help-block">OrderDate is required</span>
            <span ng-show="form.OrderDate.$dirty && form.OrderDate.$error.maxlength" class="help-block">Maximum length is 50</span>
        </div>
    </div>
    <div class="box-footer">        
        <!-- ProductID (Product) -->
        <div class="form-group">
            <label for="ddlProduct">Product</label>
            <select id="ddlProduct"
                    name="ddlProduct"
                    ng-options="option.name for option in product_data.availableOptions track by option.id"
                    ng-model="product_data.selectedOption"
                    ng-change="ddlProduct_Change(product_data.selectedOption)"></select>
        </div>

        <!-- Quantity -->
        <div class="form-group" ng-class="{ 'has-error': form.Quantity.$dirty && (form.Quantity.$error.required || form.Quantity.$error.pattern || form.Quantity.$error.maxlength) }">
            <label for="Quantity">Quantity</label>
            <input type="text" name="Quantity" id="Quantity" class="form-control" ng-model="item.Quantity" ng-minlength="1" ng-maxlength="50" ng-pattern="@FormatStandardizer.Client_Numeric" ng-change="Quantity_OnChange();" required />
            <span ng-show="form.Quantity.$dirty && form.Quantity.$error.required" class="help-block">Quantity is required</span>
            <span ng-show="form.Quantity.$dirty && form.Quantity.$error.pattern" class="help-block">Invalid Quantity.</span>
            <span ng-show="form.Quantity.$dirty && form.Quantity.$error.maxlength" class="help-block">Maximum length is 50</span>
        </div>

        <!-- Total -->
        <div class="form-group" ng-class="{ 'has-error': form.Total.$dirty && (form.Total.$error.required || form.Total.$error.pattern || form.Total.$error.maxlength) }">
            <label for="Total">Total</label>
            <input type="text" name="Total" id="Total" class="form-control" ng-model="item.Total" ng-minlength="1" ng-maxlength="50" ng-pattern="@FormatStandardizer.Client_Numeric" readonly />
            <span ng-show="form.Total.$dirty && form.Total.$error.required" class="help-block">Total is required</span>
            <span ng-show="form.Total.$dirty && form.Total.$error.pattern" class="help-block">Invalid Total.</span>
            <span ng-show="form.Total.$dirty && form.Total.$error.maxlength" class="help-block">Maximum length is 50</span>
        </div>

        <!-- TotalGST -->
        <div class="form-group" ng-class="{ 'has-error': form.TotalGST.$dirty && (form.TotalGST.$error.required || form.TotalGST.$error.pattern || form.TotalGST.$error.maxlength) }">
            <label for="TotalGST">TotalGST</label>
            <input type="text" name="TotalGST" id="TotalGST" class="form-control" ng-model="item.TotalGST" ng-minlength="1" ng-maxlength="50" ng-pattern="@FormatStandardizer.Client_Numeric" readonly />
            <span ng-show="form.TotalGST.$dirty && form.TotalGST.$error.required" class="help-block">TotalGST is required</span>
            <span ng-show="form.TotalGST.$dirty && form.TotalGST.$error.pattern" class="help-block">Invalid TotalGST.</span>
            <span ng-show="form.TotalGST.$dirty && form.TotalGST.$error.maxlength" class="help-block">Maximum length is 50</span>
        </div>

    </div>
    <div class="box-footer">
        <!-- Child Item Buttons -->
        <button ng-disabled="form.$invalid" class="btn btn-primary" ng-click="AddChildItem();">Add Child Item</button>        
    </div>
    <div class="box-footer">
        <div class="table-responsive">
            <table class="table table-striped table-condensed table-hover">
                <thead>
                    <tr>
                        <th>&nbsp;</th>                        
                        <th>ProductID</th>
                        <th>ProductName</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th>TotalGST</th>
                    </tr>
                </thead>
                <tbody ng-show="childItem.length > 0">
                    <tr ng-repeat="childItemLine in childItem">
                        <td><a href="#" data-toggle="tooltip" data-placement="right" title="Remove!" ng-click="RemoveRow(childItemLine.TempOrderDetailId);"><div class="glyphicon glyphicon-remove"></div></a></td>
                        <td>{{childItemLine.ProductID}}</td>
                        <td>{{childItemLine.ProductName}}</td>
                        <td>{{childItemLine.Quantity}}</td>
                        <td>{{childItemLine.Total}}</td>
                        <td>{{childItemLine.TotalGST}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="box-footer">
        <button ng-disabled="form.$invalid" class="btn btn-primary" ng-click="Create();">Create</button>
        &nbsp;
        <button class="btn btn-primary" ng-click="OrderByClick();">List</button>
    </div>
</form>